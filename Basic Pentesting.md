# TryHackMe - Basic Pentesting Room

<img width="587" alt="image" src="https://user-images.githubusercontent.com/114961392/206810965-f2a6172e-a913-4945-b431-89ae4ac60c90.png">

- Brute forcing  
- Hash cracking  
- Service enumeration  
- Linux Enumeration  

### Find the services exposed by the machine  
Scan all ports with nmap.  

<img width="337" alt="image" src="https://user-images.githubusercontent.com/114961392/206811674-dcbc65ae-91e0-43d9-b0b9-8718071bf819.png">

Services exposed by the machine are: SSH (Port 22), HTTP (Port 80), NetBIOS-SSN (Port 139), SMB (Port 445), ajp13 (Port 8009), and HTTPS (Port 8080).  
Looking through the web browser on port 80 reveals that the web page is under maintenance:  

<img width="245" alt="image" src="https://user-images.githubusercontent.com/114961392/206812899-c9e384ac-c498-4e70-86ac-e17b7aea9d8b.png">

### What is the name of the hidden directory on the web server?
Let's use dirsearch to brute force directories.  

<img width="478" alt="image" src="https://user-images.githubusercontent.com/114961392/206812963-368024f8-7d09-422a-b228-6e403ca27d34.png">

This reveals that the hidden directory is called **/development**.

### User brute-forcing to find the username & password
Navigating to the development directory shows us 2 text files.  

<img width="242" alt="image" src="https://user-images.githubusercontent.com/114961392/206813216-730a25ce-893d-4569-b10d-ad5be9ff3827.png">

<img width="446" alt="image" src="https://user-images.githubusercontent.com/114961392/206813329-c0a4cc04-4815-47e2-a221-1a3cb7b42bee.png">

<img width="421" alt="image" src="https://user-images.githubusercontent.com/114961392/206813731-cc58b1e4-b04e-4862-adc6-4bebd1c76e44.png">

From this we learn that:  
- SMB is configured  
- Apache is running  
- "J" password is crackable  
- Unfortunately, we can not gather any full user names as they seem to be using their initials.

Now let's check out SMB. First I will use **smbmap** to see what shares I can access. Then I will use **smbclient** to connect.  

<img width="614" alt="image" src="https://user-images.githubusercontent.com/114961392/206821571-b0ffb664-ae85-4d41-985f-28c24273f9e4.png">

There is an interesting file in the share called **staff.txt**. I will use the **get** command to download the file.  

<img width="444" alt="image" src="https://user-images.githubusercontent.com/114961392/206821713-82cf1d80-d2a4-4d53-b690-d137de8eb6fd.png">

In this file we can gather 2 user names, Jan and Kay. These look like the names of the initials we found before.  
Now that we have a username, we can try brute forcing SSH with **hydra**. I will try Jan's username first.  
**hydra -t 4 -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.10.29.112**  

<img width="638" alt="image" src="https://user-images.githubusercontent.com/114961392/206823272-1a255905-881a-49b7-8aae-2d89f374d1dd.png">

### What is the username?
Jan

### What is the password?
armando

### What service do you use to access the server?  
Now that we have cracked the password, we can log in with SSH.  

<img width="419" alt="image" src="https://user-images.githubusercontent.com/114961392/206823462-e3ea8505-8b7d-40b2-a61e-44ecf3e38102.png">

### What is the name of the other user you found?
After logging in through SSH, we can enumerate the the system for privilege escalation.  
There is an interesting file called **pass.bak** in **kay's** home directory, however we can not access it with current user permissions.  

<img width="338" alt="image" src="https://user-images.githubusercontent.com/114961392/206823844-59cf24c3-b2ff-44f0-b86b-3d5c5bb08421.png">

### If you have found another user, what can you do with this information?  
After further enumeration of Kay's directory, I noticed there is an .ssh folder with an encrypted private key. I will set up a python server on the target system to transfer the key back to my host machine using curl.  

<img width="413" alt="image" src="https://user-images.githubusercontent.com/114961392/206824191-d470e6ea-1270-4187-9004-ca54b8cb6433.png">

Since the key is encrypted, I will use the **ssh2john module** to first create a hash from the file, then crack it using **John The Ripper**.  

<img width="493" alt="image" src="https://user-images.githubusercontent.com/114961392/206824398-f2e8f60f-ac29-48f9-86df-25fb05d7c721.png">

Password: beeswax  

Now we can connect to Kay's account using SSH.  

<img width="485" alt="image" src="https://user-images.githubusercontent.com/114961392/206824521-4dacf619-547d-46b1-b071-8602c361ef5a.png">

### What is the final password you obtain?  
After we can connected to Kay's account through SSH, we now have the privileges to access the **pass.bak** file which contains the final password.  

<img width="293" alt="image" src="https://user-images.githubusercontent.com/114961392/206824738-6317a89b-9b09-45ad-a745-efbb23d9ca22.png">

